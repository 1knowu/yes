import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures,StandardScaler
from sklearn.pipeline import make_pipeline

def linear_regression_on():
  df=pd.read_csv("https://raw.githubusercontent.com/Selva86/datasets/master/BostonHousing.csv")

  X=df[['rm']].values
  y=df['medv'].values

  X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
  model=LinearRegression().fit(X_train,y_train)
  y_pred=model.predict(X_test)

  plt.figure(figsize=(10,6))
  plt.scatter(X_test,y_test,color="blue",label='yes')
  plt.plot(X_test,y_pred,color="red",label='no')
  plt.xlabel('rm')
  plt.ylabel('medv')
  plt.legend()
  plt.show()

  print("linear regression")
  print("Mean squared error: %.2f" , mean_squared_error(y_test, y_pred))
  print("Coefficient of determination: %.2f" , r2_score(y_test, y_pred))



 def polynomial_regression_auto():
    url="https://archive.ics.uci.edu/ml/machine-learning-databases/auto-mpg/auto-mpg.data"
    column_names=['mpg','cylinders','displacement','horsepower','weight','acceleration','model_year','origin']

    data=pd.read_csv(url,sep='\s+',names=column_names,na_values='?')
    data=data.dropna()

    X=data['displacement'].values.reshape(-1,1)
    y=data['mpg'].values

    X_train, X_test, y_train, y_test=train_test_split(X,y,test_size=0.2,random_state=42)
    poly_model=make_pipeline(PolynomialFeatures(degree=2),StandardScaler(),LinearRegression())
    poly_model.fit(X_train,y_train)

    y_pred=poly_model.predict(X_test)

    plt.scatter(X_test,y_test,color="blue",label='yes')
    plt.scatter(X_test,y_pred,color="red",label='no')
    plt.xlabel('displacement')
    plt.ylabel('mpg')
    plt.legend
    plt.show()

    print("Polynomial Regression - Auto MPG Dataset")
    print("Mean Squared Error:", mean_squared_error(y_test, y_pred))
    print("R^2 Score:", r2_score(y_test, y_pred))


if __name__=='__main__':
    linear_regression_on()
    polynomial_regression_auto()

 